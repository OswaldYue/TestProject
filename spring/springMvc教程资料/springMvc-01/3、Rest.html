<html>
<head>
  <title>Evernote Export</title>
  <basefont face="微软雅黑" size="2" />
  <meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
  <meta name="exporter-version" content="Evernote Windows/304720 (zh-CN, DDL); Windows/10.0.14393 (Win64);"/>
  <style>
    body, td {
      font-family: 微软雅黑;
      font-size: 10pt;
    }
  </style>
</head>
<body>
<a name="3261"/>
<h1>3、Rest</h1>
<div>
<table bgcolor="#D4DDE5" border="0">
<tr><td><b>创建时间：</b></td><td><i>2017/6/19 14:30</i></td></tr>
<tr><td><b>更新时间：</b></td><td><i>2017/6/19 16:16</i></td></tr>
<tr><td><b>作者：</b></td><td><i>雷丰阳</i></td></tr>
</table>
</div>
<br/>

<div>
<span><div>Rest：系统希望以非常简洁的URL地址来发请求；</div><div>          怎样表示对一个资源的增删改查用请求方式来区分</div><div><br/></div><div>/getBook?id=1   ：查询图书</div><div>/deleteBook?id=1：删除1号图书</div><div>/updateBook?id=1:更新1号图书</div><div>/addBook     ：添加图书</div><div><hr/></div><div>Rest推荐；</div><div>     url地址这么起名；  /资源名/资源标识符</div><div>/book/1          ：GET-----查询1号图书</div><div>/book/1          :PUT------更新1号图书</div><div>/book/1          :DELETE-----删除1号图书</div><div>/book               :POST-----添加图书</div><div>系统的URL地址就这么来设计即可；</div><div>     简洁的URL提交请求，以请求方式区分对资源操作；</div><div>问题：从页面上只能发起两种请求，GET、POST；</div><div>其他的请求方式没法使用；</div><div><br/></div><div><hr/></div><div>使用Rest来构建一个增删改查系统；</div><div>页面地址：</div><div align="left" style="min-height: 18pt;"><font color="#3F5FBF" face="Consolas" size="4"><span style="font-size:16pt">&lt;!-- 发起图书的增删改查请求；使用Rest风格的URL地址；</span></font></div><div align="left" style="min-height: 18pt;"><font color="#3F5FBF" face="Consolas" size="4"><span style="font-size:16pt">请求</span><span style="font-size:16pt"><u>url</u></span><span style="font-size:16pt">  请求方式 表示含义</span></font></div><div align="left" style="min-height: 18pt;"><font color="#3F5FBF" face="Consolas" size="4"><span style="font-size:16pt">/book/1 GET：   查询1号图书</span></font></div><div align="left" style="min-height: 18pt;"><font color="#3F5FBF" face="Consolas" size="4"><span style="font-size:16pt">/book/1 DELETE：删除1号图书</span></font></div><div align="left" style="min-height: 18pt;"><font color="#3F5FBF" face="Consolas" size="4"><span style="font-size:16pt">/book/1 PUT：   更新1号图书</span></font></div><div align="left" style="min-height: 18pt;"><font color="#3F5FBF" face="Consolas" size="4"><span style="font-size:16pt">/book   POST：  添加1号图书</span></font></div><div align="left" style="min-height: 18pt;"><font color="#3F5FBF" face="Consolas" size="4"><span style="font-size:16pt">从页面发起PUT、DELETE形式的请求</span></font></div><div align="left" style="min-height: 18pt;"><div><font color="#3F5FBF" face="Consolas" size="4"><span style="font-size:16pt"> --&gt;</span></font></div><div><span style="font-family: Consolas;"><span style="color: rgb(63, 95, 191);"><br/></span></span></div></div><div><br/></div><div>处理程序：</div><div align="left" style="min-height: 18pt;"><div style="-en-codeblock: true; box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.14902); background-position: initial initial; background-repeat: initial initial;"><div>package com.atguigu.controller;</div><div><br/></div><div>import org.springframework.stereotype.Controller;</div><div>import org.springframework.web.bind.annotation.PathVariable;</div><div>import org.springframework.web.bind.annotation.RequestMapping;</div><div>import org.springframework.web.bind.annotation.RequestMethod;</div><div><br/></div><div>@Controller</div><div>public class BookController {</div><div>    /**</div><div>     * 处理查询图书请求</div><div>     * @param id</div><div>     * @return</div><div>     */</div><div>    @RequestMapping(value=&quot;/book/{bid}&quot;,method=RequestMethod.GET)</div><div>    public String getBook(@PathVariable(&quot;bid&quot;)Integer id) {</div><div>        System.out.println(&quot;查询到了&quot;+id+&quot;号图书&quot;);</div><div>        return &quot;success&quot;;</div><div>    }</div><div><br/></div><div>    /**</div><div>     * 图书删除</div><div>     * @param id</div><div>     * @return</div><div>     */</div><div>    @RequestMapping(value=&quot;/book/{bid}&quot;,method=RequestMethod.DELETE)</div><div>    public String deleteBook(@PathVariable(&quot;bid&quot;)Integer id) {</div><div>        System.out.println(&quot;删除了&quot;+id+&quot;号图书&quot;);</div><div>        return &quot;success&quot;;</div><div>    }</div><div><br/></div><div>    /**</div><div>     * 图书更新</div><div>     * @return</div><div>     */</div><div>    @RequestMapping(value=&quot;/book/{bid}&quot;,method=RequestMethod.PUT)</div><div>    public String updateBook(@PathVariable(&quot;bid&quot;)Integer id) {</div><div>        System.out.println(&quot;更新了&quot;+id+&quot;号图书&quot;);</div><div>        return &quot;success&quot;;</div><div>    }</div><div><br/></div><div>    @RequestMapping(value=&quot;/book&quot;,method=RequestMethod.POST)</div><div>    public String addBook() {</div><div>        System.out.println(&quot;添加了新的图书&quot;);</div><div>        return &quot;success&quot;;</div><div>    }</div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div>}</div></div><div><br/></div></div><div><br/></div><div><br/></div><div><hr/></div><div align="left" style="min-height: 18pt;"><div><br/></div><div style="-en-codeblock: true; box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.14902); background-position: initial initial; background-repeat: initial initial;"><div>@Override</div><div>    protected void doFilterInternal(HttpServletRequest request, HttpServletResponse response, FilterChain filterChain)</div><div>            throws ServletException, IOException {</div><div>     //获取表单上_method带来的值（delete\put）</div><div>        String paramValue = request.getParameter(this.methodParam);</div><div>     </div><div>     //判断如过表单是一个post而且_method有值</div><div>        if (&quot;POST&quot;.equals(request.getMethod()) &amp;&amp; StringUtils.hasLength(paramValue)) {</div><div>          //转为PUT、DELETE</div><div>            String method = paramValue.toUpperCase(Locale.ENGLISH);</div><div>          //重写了request.getMethod()；</div><div>            HttpServletRequest wrapper = new HttpMethodRequestWrapper(request, method);</div><div><br/></div><div>          //wrapper.getMethod()===PUT；</div><div>            filterChain.doFilter(wrapper, response);</div><div>        }</div><div>        else {</div><div>             //直接放行</div><div>            filterChain.doFilter(request, response);</div><div>        }</div><div>    }</div></div><div><br/></div><div><hr/></div><div><br/></div></div><div align="left" style="min-height: 18pt;"><font color="#3F5FBF" face="Consolas" size="4"><span style="font-size:16pt">从页面发起PUT、DELETE形式的请求?Spring提供了对Rest风格的支持</span></font></div><div align="left" style="min-height: 18pt;"><font color="#3F5FBF" face="Consolas" size="4"><span style="font-size:16pt">1）、SpringMVC中有一个Filter；他可以把普通的请求转化为规定形式的请求；配置这个filter;</span></font></div><div align="left" style="min-height: 18pt;"><font color="#3F5FBF" face="Consolas" size="4"><span style="font-size:16pt">&lt;filter&gt;</span></font></div><div align="left" style="min-height: 11pt;"><font color="#3F5FBF" face="Consolas" size="4"><span style="font-size:16pt">        &lt;filter-name&gt;HiddenHttpMethodFilter&lt;/filter-name&gt;</span></font></div><div align="left" style="min-height: 11pt;"><font color="#3F5FBF" face="Consolas" size="4"><span style="font-size:16pt">        &lt;filter-class&gt;org.springframework.web.filter.HiddenHttpMethodFilter&lt;/filter-class&gt;</span></font></div><div align="left" style="min-height: 18pt;"><font color="#3F5FBF" face="Consolas" size="4"><span style="font-size:16pt">    &lt;/filter&gt;</span></font></div><div align="left" style="min-height: 18pt;"><font color="#3F5FBF" face="Consolas" size="4"><span style="font-size:16pt">    &lt;filter-mapping&gt;</span></font></div><div align="left" style="min-height: 11pt;"><font color="#3F5FBF" face="Consolas" size="4"><span style="font-size:16pt">        &lt;filter-name&gt;HiddenHttpMethodFilter&lt;/filter-name&gt;</span></font></div><div align="left" style="min-height: 18pt;"><font color="#3F5FBF" face="Consolas" size="4"><span style="font-size:16pt">        &lt;url-pattern&gt;/*&lt;/url-pattern&gt;</span></font></div><div align="left" style="min-height: 18pt;"><font color="#3F5FBF" face="Consolas" size="4"><span style="font-size:16pt">    &lt;/filter-mapping&gt;</span></font></div><div align="left" style="min-height: 18pt;"><font color="#3F5FBF" face="Consolas" size="4"><span style="font-size:16pt">2）、如何发其他形式请求？</span></font></div><div align="left" style="min-height: 18pt;"><font color="#3F5FBF" face="Consolas" size="4"><span style="font-size:16pt">    按照以下要求；1、创建一个post类型的表单 2、表单项中携带一个_method的参数，3、这个_method的值就是DELETE、PUT</span></font></div><div align="left" style="min-height: 18pt;"><font color="#3F5FBF" face="Consolas" size="4"><span style="font-size:16pt"> --&gt;</span></font></div><div align="left" style="min-height: 18pt;"><font color="#008080" face="Consolas" size="4"><span style="font-size:16pt">&lt;</span></font><font color="#3F7F7F" face="Consolas" size="4"><span style="font-size:16pt">a</span></font> <font color="#7F007F" face="Consolas" size="4"><span style="font-size:16pt">href</span></font><font face="Consolas" size="4"><span style="font-size:16pt">=</span></font><font color="#2A00FF" face="Consolas" size="4"><span style="font-size:16pt"><i>&quot;book/1&quot;</i></span></font><font color="#008080" face="Consolas" size="4"><span style="font-size:16pt">&gt;</span></font><font face="Consolas" size="4"><span style="font-size:16pt">查询图书</span></font><font color="#008080" face="Consolas" size="4"><span style="font-size:16pt">&lt;/</span></font><font color="#3F7F7F" face="Consolas" size="4"><span style="font-size:16pt">a</span></font><font color="#008080" face="Consolas" size="4"><span style="font-size:16pt">&gt;&lt;</span></font><font color="#3F7F7F" face="Consolas" size="4"><span style="font-size:16pt">br</span></font><font color="#008080" face="Consolas" size="4"><span style="font-size:16pt">/&gt;</span></font></div><div align="left" style="min-height: 18pt;"><font color="#008080" face="Consolas" size="4"><span style="font-size:16pt">&lt;</span></font><font color="#3F7F7F" face="Consolas" size="4"><span style="font-size:16pt">form</span></font> <font color="#7F007F" face="Consolas" size="4"><span style="font-size:16pt">action</span></font><font face="Consolas" size="4"><span style="font-size:16pt">=</span></font><font color="#2A00FF" face="Consolas" size="4"><span style="font-size:16pt"><i>&quot;book&quot;</i></span></font> <font color="#7F007F" face="Consolas" size="4"><span style="font-size:16pt">method</span></font><font face="Consolas" size="4"><span style="font-size:16pt">=</span></font><font color="#2A00FF" face="Consolas" size="4"><span style="font-size:16pt"><i>&quot;post&quot;</i></span></font><font color="#008080" face="Consolas" size="4"><span style="font-size:16pt">&gt;</span></font></div><div align="left" style="min-height: 18pt;"><font face="Consolas" size="4"><span style="font-size:16pt">    </span></font><font color="#008080" face="Consolas" size="4"><span style="font-size:16pt">&lt;</span></font><font color="#3F7F7F" face="Consolas" size="4"><span style="font-size:16pt">input</span></font> <font color="#7F007F" face="Consolas" size="4"><span style="font-size:16pt">type</span></font><font face="Consolas" size="4"><span style="font-size:16pt">=</span></font><font color="#2A00FF" face="Consolas" size="4"><span style="font-size:16pt"><i>&quot;submit&quot;</i></span></font> <font color="#7F007F" face="Consolas" size="4"><span style="font-size:16pt">value</span></font><font face="Consolas" size="4"><span style="font-size:16pt">=</span></font><font color="#2A00FF" face="Consolas" size="4"><span style="font-size:16pt"><i>&quot;添加1号图书&quot;</i></span></font><font color="#008080" face="Consolas" size="4"><span style="font-size:16pt">/&gt;</span></font></div><div align="left" style="min-height: 18pt;"><font color="#008080" face="Consolas" size="4"><span style="font-size:16pt">&lt;/</span></font><font color="#3F7F7F" face="Consolas" size="4"><span style="font-size:16pt">form</span></font><font color="#008080" face="Consolas" size="4"><span style="font-size:16pt">&gt;&lt;</span></font><font color="#3F7F7F" face="Consolas" size="4"><span style="font-size:16pt">br</span></font><font color="#008080" face="Consolas" size="4"><span style="font-size:16pt">/&gt;</span></font></div><div align="left" style="min-height: 18pt;"><font color="#3F5FBF" face="Consolas" size="4"><span style="font-size:16pt">&lt;!-- 发送DELETE请求 --&gt;</span></font></div><div align="left" style="min-height: 18pt;"><font color="#008080" face="Consolas" size="4"><span style="font-size:16pt">&lt;</span></font><font color="#3F7F7F" face="Consolas" size="4"><span style="font-size:16pt">form</span></font> <font color="#7F007F" face="Consolas" size="4"><span style="font-size:16pt">action</span></font><font face="Consolas" size="4"><span style="font-size:16pt">=</span></font><font color="#2A00FF" face="Consolas" size="4"><span style="font-size:16pt"><i>&quot;book/1&quot;</i></span></font> <font color="#7F007F" face="Consolas" size="4"><span style="font-size:16pt">method</span></font><font face="Consolas" size="4"><span style="font-size:16pt">=</span></font><font color="#2A00FF" face="Consolas" size="4"><span style="font-size:16pt"><i>&quot;post&quot;</i></span></font><font color="#008080" face="Consolas" size="4"><span style="font-size:16pt">&gt;</span></font></div><div align="left" style="min-height: 18pt;"><font face="Consolas" size="4"><span style="font-size:16pt">    </span></font><font color="#008080" face="Consolas" size="4"><span style="font-size:16pt">&lt;</span></font><font color="#3F7F7F" face="Consolas" size="4"><span style="font-size:16pt">input</span></font> <font color="#7F007F" face="Consolas" size="4"><span style="font-size:16pt">name</span></font><font face="Consolas" size="4"><span style="font-size:16pt">=</span></font><font color="#2A00FF" face="Consolas" size="4"><span style="font-size:16pt"><i>&quot;_method&quot;</i></span></font> <font color="#7F007F" face="Consolas" size="4"><span style="font-size:16pt">value</span></font><font face="Consolas" size="4"><span style="font-size:16pt">=</span></font><font color="#2A00FF" face="Consolas" size="4"><span style="font-size:16pt"><i>&quot;delete&quot;</i></span></font><font color="#008080" face="Consolas" size="4"><span style="font-size:16pt">/&gt;</span></font></div><div align="left" style="min-height: 18pt;"><font face="Consolas" size="4"><span style="font-size:16pt">    </span></font><font color="#008080" face="Consolas" size="4"><span style="font-size:16pt">&lt;</span></font><font color="#3F7F7F" face="Consolas" size="4"><span style="font-size:16pt">input</span></font> <font color="#7F007F" face="Consolas" size="4"><span style="font-size:16pt">type</span></font><font face="Consolas" size="4"><span style="font-size:16pt">=</span></font><font color="#2A00FF" face="Consolas" size="4"><span style="font-size:16pt"><i>&quot;submit&quot;</i></span></font> <font color="#7F007F" face="Consolas" size="4"><span style="font-size:16pt">value</span></font><font face="Consolas" size="4"><span style="font-size:16pt">=</span></font><font color="#2A00FF" face="Consolas" size="4"><span style="font-size:16pt"><i>&quot;删除1号图书&quot;</i></span></font><font color="#008080" face="Consolas" size="4"><span style="font-size:16pt">/&gt;</span></font></div><div align="left" style="min-height: 18pt;"><font color="#008080" face="Consolas" size="4"><span style="font-size:16pt">&lt;/</span></font><font color="#3F7F7F" face="Consolas" size="4"><span style="font-size:16pt">form</span></font><font color="#008080" face="Consolas" size="4"><span style="font-size:16pt">&gt;&lt;</span></font><font color="#3F7F7F" face="Consolas" size="4"><span style="font-size:16pt">br</span></font><font color="#008080" face="Consolas" size="4"><span style="font-size:16pt">/&gt;</span></font></div><div align="left" style="min-height: 18pt;"><font color="#3F5FBF" face="Consolas" size="4"><span style="font-size:16pt">&lt;!-- 发送PUT请求 --&gt;</span></font></div><div align="left" style="min-height: 18pt;"><font color="#008080" face="Consolas" size="4"><span style="font-size:16pt">&lt;</span></font><font color="#3F7F7F" face="Consolas" size="4"><span style="font-size:16pt">form</span></font> <font color="#7F007F" face="Consolas" size="4"><span style="font-size:16pt">action</span></font><font face="Consolas" size="4"><span style="font-size:16pt">=</span></font><font color="#2A00FF" face="Consolas" size="4"><span style="font-size:16pt"><i>&quot;book/1&quot;</i></span></font> <font color="#7F007F" face="Consolas" size="4"><span style="font-size:16pt">method</span></font><font face="Consolas" size="4"><span style="font-size:16pt">=</span></font><font color="#2A00FF" face="Consolas" size="4"><span style="font-size:16pt"><i>&quot;post&quot;</i></span></font><font color="#008080" face="Consolas" size="4"><span style="font-size:16pt">&gt;</span></font></div><div align="left" style="min-height: 18pt;"><font face="Consolas" size="4"><span style="font-size:16pt">    </span></font><font color="#008080" face="Consolas" size="4"><span style="font-size:16pt">&lt;</span></font><font color="#3F7F7F" face="Consolas" size="4"><span style="font-size:16pt">input</span></font> <font color="#7F007F" face="Consolas" size="4"><span style="font-size:16pt">name</span></font><font face="Consolas" size="4"><span style="font-size:16pt">=</span></font><font color="#2A00FF" face="Consolas" size="4"><span style="font-size:16pt"><i>&quot;_method&quot;</i></span></font> <font color="#7F007F" face="Consolas" size="4"><span style="font-size:16pt">value</span></font><font face="Consolas" size="4"><span style="font-size:16pt">=</span></font><font color="#2A00FF" face="Consolas" size="4"><span style="font-size:16pt"><i>&quot;put&quot;</i></span></font><font color="#008080" face="Consolas" size="4"><span style="font-size:16pt">/&gt;</span></font></div><div align="left" style="min-height: 18pt;"><font face="Consolas" size="4"><span style="font-size:16pt">    </span></font><font color="#008080" face="Consolas" size="4"><span style="font-size:16pt">&lt;</span></font><font color="#3F7F7F" face="Consolas" size="4"><span style="font-size:16pt">input</span></font> <font color="#7F007F" face="Consolas" size="4"><span style="font-size:16pt">type</span></font><font face="Consolas" size="4"><span style="font-size:16pt">=</span></font><font color="#2A00FF" face="Consolas" size="4"><span style="font-size:16pt"><i>&quot;submit&quot;</i></span></font> <font color="#7F007F" face="Consolas" size="4"><span style="font-size:16pt">value</span></font><font face="Consolas" size="4"><span style="font-size:16pt">=</span></font><font color="#2A00FF" face="Consolas" size="4"><span style="font-size:16pt"><i>&quot;更新1号图书&quot;</i></span></font><font color="#008080" face="Consolas" size="4"><span style="font-size:16pt">/&gt;</span></font></div><div align="left" style="min-height: 18pt;"><div><font color="#008080" face="Consolas" size="4"><span style="font-size:16pt">&lt;/</span></font><font color="#3F7F7F" face="Consolas" size="4"><span style="font-size:16pt">form</span></font><font color="#008080" face="Consolas" size="4"><span style="font-size:16pt">&gt;&lt;</span></font><font color="#3F7F7F" face="Consolas" size="4"><span style="font-size:16pt">br</span></font><font color="#008080" face="Consolas" size="4"><span style="font-size:16pt">/&gt;</span></font></div></div><div><br/></div><div><br/></div><div><hr/></div><div align="left" style="min-height: 18pt;"><div><br/></div><div style="-en-codeblock: true; box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.14902); background-position: initial initial; background-repeat: initial initial;"><div>&lt;filter&gt;</div><div>        &lt;filter-name&gt;HiddenHttpMethodFilter&lt;/filter-name&gt;</div><div>        &lt;filter-class&gt;org.springframework.web.filter.HiddenHttpMethodFilter&lt;/filter-class&gt;</div><div>    &lt;/filter&gt;</div><div>    &lt;filter-mapping&gt;</div><div>        &lt;filter-name&gt;HiddenHttpMethodFilter&lt;/filter-name&gt;</div><div>        &lt;url-pattern&gt;/*&lt;/url-pattern&gt;</div><div>    &lt;/filter-mapping&gt;</div></div><div>注意：高版本Tomcat；Rest支持有点问题</div><div><img src="3、Rest_files/Image.png" type="image/png"/></div><div><br/></div><div><br/></div><div>解决方案：</div><div><img src="3、Rest_files/Image [1].png" type="image/png"/></div></div><div><br/></div><div><br/></div><div><br/></div></span>
</div></body></html> 